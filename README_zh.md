# MemorySpaceExplorer 🚀

**MemorySpaceExplorer** 是一款专为 Windows 打造的高性能物理内存与 NVIDIA 显存可视化分析及优化工具。它采用 **矩形树图 (TreeMap)** 布局，为您提供直观、清晰的系统资源分配视图。

**简体中文** | [English](./README.md)

---

## ✨ 核心特性

### 📊 可视化资源分析
- **矩形树图可视化**: 采用高性能 Squarified Treemap 算法，展示物理内存、交换区和显存占用。
- **双查看模式**:
  - **程序模式**: 自动聚合同一应用（如 Chrome 标签页）的进程，快速定位内存大户。
  - **独立进程模式**: 展示每个 PID 的详细占用。

### 🎮 游戏与性能
- **游戏模式 (自动避让)**: 自动检测全屏/无边框游戏，暂停监控与优化以确保零干扰。激活时云图右下角会显示 🎮 图标。
- **动态托盘图标**: 托盘图标包含 4 条实时柱状图：
  - **左侧 2 条**: 内存占用。
  - **右侧 2 条**: GPU 显存占用。
- **智能优化**: 利用 Windows API 周期性释放闲置进程的工作集，保持系统流畅。

### 🛠 高级 GPU 与 CPU 管理
- **精准显存追踪**: 结合 `pynvml`、`nvidia-smi` 和 PowerShell 性能计数器，通过 **LUID 匹配** 准确识别进程级显存占用（支持多显卡）。
- **CPU 亲和性**: 直接从右键菜单查看进程链并设置 CPU 核心亲和性。
- **权限处理**: 如果标准方法受限，自动尝试通过 Windows API 获取进程名。

### 🎨 现代 UI 体验
- **折叠式设置**: 采用折叠面板管理复杂配置，界面井然有序。
- **自定义主题**: 可调整系统、GPU 及可用内存的色块颜色。
- **文档路径存储**: 配置文件存放在用户“文档”文件夹中，安全且易于访问。

---

## 🖥 系统要求
- **操作系统**: Windows 10/11
- **Python 环境**: 3.8+
- **硬件**: NVIDIA GPU（用于显存监控功能）。

---

## 📦 安装步骤

1. **获取代码**
   ```bash
   git clone https://github.com/yourusername/memory_anaylize_tool.git
   cd memory_anaylize_tool
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```
   *(必要依赖: `PyQt6`, `psutil`, `pynvml`)*

---

## 🛠 使用说明

1. **运行程序**
   ```bash
   python main.py
   ```
2. **交互操作**:
   - **左键双击**: 查看聚合组的详细进程列表。
   - **右键单击**: 打开管理菜单（定位文件、结束进程、CPU 亲和性）。
   - **托盘图标**: 悬停查看简报，右键快速操作。

---

## 💡 提示
- **管理员权限**: 建议以管理员身份运行，以获取完整的进程信息并实现深度内存优化。
- **显存方案自适应**: 程序会根据环境自动选择最佳方案（NVML > XML > CSV > PowerShell）进行显存监控。

---

## ⚖ 开源协议
MIT License

