# MemorySpaceExplorer 🚀

**MemorySpaceExplorer** 是一款专为 Windows 打造的高性能物理内存与 NVIDIA 显存可视化分析及优化工具。它采用 **矩形树图 (TreeMap)** 布局，为您提供直观、清晰的系统资源分配视图。

## 🖼 截图展示

| 主界面 (中文) | 主界面 (英文) |
| :---: | :---: |
| ![中文界面](./pics/image%20zh.png) | ![英文界面](./pics/image%20en.png) |

| 折叠式设置面板 |
| :---: |
| ![设置页面](./pics/image%20setting.png) |

**简体中文** | [English](./README.md)

---

## ✨ 核心特性

### 📊 可视化资源分析
- **矩形树图可视化**: 采用高性能 Squarified Treemap 算法，展示物理内存、交换区和显存占用。
- **双查看模式**:
  - **程序模式**: 自动聚合同一应用（如 Chrome 标签页）的进程，快速定位内存大户。
  - **独立进程模式**: 展示每个 PID 的详细占用。

### 🎮 游戏与性能
- **游戏模式 (自动避让)**: 自动检测全屏/无边框游戏，暂停监控与优化以确保零干扰。激活时云图右下角会显示 🎮 图标。
- **动态托盘图标**: 托盘图标包含 4 条实时柱状图：
  - **左侧 2 条**: 内存占用。
  - **右侧 2 条**: GPU 显存占用。
- **智能优化**: 利用 Windows API 周期性释放闲置进程的工作集，保持系统流畅。

### 🛠 高级 GPU 与 CPU 管理
- **精准显存追踪**: 结合 `pynvml`、`nvidia-smi` 和 PowerShell 性能计数器，通过 **LUID 匹配** 准确识别进程级显存占用（支持多显卡）。
- **CPU 亲和性**: 直接从右键菜单查看进程链并设置 CPU 核心亲和性。
- **权限处理**: 如果标准方法受限，自动尝试通过 Windows API 获取进程名。

### 🎨 现代 UI 体验
- **折叠式设置**: 采用折叠面板管理复杂配置，界面井然有序。
- **自定义主题**: 可调整系统、GPU 及可用内存的色块颜色。
- **多语言支持 (I18N)**: 完整支持中英文切换，所有文本通过 `config.py` 统一治理。
- **文档路径存储**: 配置文件存放在用户“文档”文件夹中，安全且易于访问。

---

## 🖥 系统要求
- **操作系统**: Windows 10/11
- **Python 环境**: 3.8+
- **硬件**: NVIDIA GPU（用于显存监控功能）。

---

## 💾 获取程序

### 1. 直接下载 (推荐)
您可以直接从项目的 `dist` 目录下载已经构建好的可执行文件，无需安装 Python 环境：
- 📥 **[下载 MemoryUitl.exe](./dist/MemoryUitl.exe)**

### 2. 源码运行
如果您希望从源码运行，请参考下方的安装步骤。

---

## 📦 安装步骤

1. **获取代码**
   ```bash
   git clone https://github.com/yourusername/memory_anaylize_tool.git
   cd memory_anaylize_tool
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```
   *(必要依赖: `PyQt6`, `psutil`, `pynvml`)*

---

## 🛠 使用说明

1. **运行程序**
   ```bash
   python main.py
   ```
2. **交互操作**:
   - **左键双击**: 查看聚合组的详细进程列表。
   - **右键单击**: 打开管理菜单（定位文件、结束进程、CPU 亲和性）。
   - **托盘图标**: 悬停查看简报，右键快速操作。

---

## 🏗 自行打包为 EXE

如果您修改了代码并希望自行生成 EXE 文件，请按照以下步骤操作：

1. **安装 PyInstaller**:
   ```bash
   pip install pyinstaller
   ```

2. **执行打包命令 (推荐使用 Spec 文件)**:
   ```bash
   pyinstaller --clean MemoryUitl.spec
   ```
   *(注：由于项目已进行模块化拆分，直接打包 `main.py` 可能会导致缺少模块。使用 `.spec` 文件可确保所有子文件夹都被正确包含。)*

3. **版本信息**: 
   您可以编辑 `file_version_info.txt` 来修改生成的 EXE 属性（如版权、版本号等）。

---

## 📂 项目结构

项目经过重构，采用了模块化设计以提高可维护性：
- `main.py`: 应用程序入口及主窗口。
- `config.py`: 多语言治理 (I18N) 及全局配置管理。
- `ui/`: 包含所有 UI 组件和对话框。
- `utils/`: 包含核心布局算法、数据采集逻辑及系统辅助工具。

---

## 💡 提示
- **管理员权限**: 建议以管理员身份运行，以获取完整的进程信息并实现深度内存优化。
- **显存方案自适应**: 程序会根据环境自动选择最佳方案（NVML > XML > CSV > PowerShell）进行显存监控。

---

## ⚖ 开源协议
MIT License

